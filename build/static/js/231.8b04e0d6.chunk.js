"use strict";(self.webpackChunkfetech=self.webpackChunkfetech||[]).push([[231],{2603:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var a=n(2791),o=n(7689),l=n(8267),s=(n(8107),n(6518)),d=n(1918),i=n(3767),r=n(9013),c=n(184);const u=()=>{const[e,t]=(0,a.useState)([]),n=(e,t)=>{e.dataTransfer.setData("application/reactflow",t),e.dataTransfer.setData("id",e.target.id),e.dataTransfer.setData("value",e.target.innerText),e.dataTransfer.effectAllowed="move"};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("aside",{children:[(0,c.jsx)("form",{children:(0,c.jsxs)("label",{htmlFor:"excelupload",style:{color:"#62B2EA",cursor:"pointer",fontSize:"18px",border:"2px #62B2EA solid ",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"space-around"},children:[(0,c.jsx)(r.Z,{}),"Please Upload Excel",(0,c.jsx)("input",{id:"excelupload",type:"file",onChange:e=>(e=>{try{if("xlsx"!==e.target.files[0].name.split(".")[1])throw"please Upload Excel file";(0,s.Z)(e.target.files[0]).then((e=>{t(e[0])}))}catch(n){console.log("err",n)}})(e),style:{display:"none"}})]})}),(0,c.jsx)("hr",{}),(0,c.jsx)("h2",{style:{color:"#1976D2",margin:"15px"},className:"description",children:"You can drag these nodes to the pane on the right."}),(0,c.jsx)("div",{className:"dndnode input",onDragStart:e=>n(e,"input"),draggable:!0,children:"Input Node"}),(0,c.jsx)("div",{className:"dndnode",id:"groupnode_0",onDragStart:e=>n(e,"textupdater"),draggable:!0,children:"Group"}),(0,c.jsx)("div",{className:"dndnode output",id:"button",onDragStart:e=>n(e,"buttonNode"),draggable:!0,children:"Button"}),(0,c.jsx)("div",{className:"dndnode output",onDragStart:e=>n(e,"textAreaUpdater"),draggable:!0,children:"Text"}),(0,c.jsx)("hr",{}),(0,c.jsx)("h3",{style:{color:"#62B2EA"},children:"Excel Column"}),e.length>0?(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(i.Z,{direction:"column",spacing:1,className:"stackname",children:e.map(((e,t)=>(0,c.jsx)(d.Z,{className:"chipname",label:e,onDelete:()=>console.log("delete"),id:t,onDragStart:e=>n(e,"headtext"),draggable:!0},t)))})}):"Please Upload Excel to set the Text"]})})};var p=n(5130),h=n(4420);const g=e=>{let{onDeleteInstance:t,deleteId:n}=e,a=(0,h.v9)((e=>e.flow.instanceNode));return(0,c.jsx)(p.Z,{fontSize:"small",className:"iconstyle",onClick:()=>{(()=>{let e=null===a||void 0===a?void 0:a.getNodes().filter((e=>e.id===n));a.deleteElements({nodes:e})})()}})};var x=n(8968);const f=e=>t=>{let{data:n,...o}=t,l=(0,a.useContext)(x.s),s=n.nodeId,{changeValue:d}=l;const[i,r]=(0,a.useState)(n.inputValue||"");(0,a.useEffect)((()=>{n.label&&r(n.label)}),[]);return(0,c.jsx)(e,{handleChange:e=>{const t=e.target.value;r(t),d(e.target.value,s)},handleDrop:e=>{let t="{".concat(e.dataTransfer.getData("value"),"}"),n=i+t;r((e=>e+t)),d(n,s)},inputValue:i,dataone:n,...o})};const v=f((function(e){const{dataone:t,isConnectable:n,handleChange:a,inputValue:o}=e;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{style:{position:"relative"},children:[(0,c.jsx)(l.HH,{type:"source",className:"chathandleright chathandle",position:l.Ly.Right,isConnectable:n,style:{borderColor:"black !important"}}),(0,c.jsx)(l.HH,{type:"target",className:"chathandle",position:l.Ly.Left,isConnectable:n,style:{borderColor:"black !important"}}),(0,c.jsx)("input",{type:"text",value:o,className:"activeborder ",style:{backgroundColor:"#b1bab3",border:"none",width:"80px",height:"40px",borderRadius:"5px",textAlign:"center",boxShadow:" -4px 5px 5px 0px rgba(225, 230, 226)"},onChange:e=>a(e)}),(0,c.jsx)("span",{className:"customhandle"}),(0,c.jsx)(g,{deleteId:t.nodeId})]})})}));n(1174);const m=f((e=>{let{isConnectable:t,handleDelete:n,handleChange:a,handleDrop:o,inputValue:s,dataone:d}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.HH,{className:"chathandle",type:"target",position:l.Ly.Left}),(0,c.jsx)(l.HH,{className:"chathandle",type:"source",position:l.Ly.Right}),(0,c.jsxs)("div",{className:"textareacontainer",style:{position:"relative"},children:[(0,c.jsxs)("div",{className:"textareadiv quickdiv",style:{backgroundColor:"#db5290"},children:[" ","Response"," "]}),(0,c.jsx)("div",{children:(0,c.jsx)("textarea",{rows:"5",cols:"15",className:"grouptextarea activeborder",value:s,onChange:e=>a(e),onDrop:e=>o(e)})}),(0,c.jsx)(g,{deleteId:d.nodeId})]})]})}));var b=n(6620);function j(){return(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"#ff0071",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",style:{position:"absolute",right:5,bottom:5},children:[(0,c.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,c.jsx)("polyline",{points:"16 20 20 20 20 16"}),(0,c.jsx)("line",{x1:"14",y1:"14",x2:"20",y2:"20"}),(0,c.jsx)("polyline",{points:"8 4 4 4 4 8"}),(0,c.jsx)("line",{x1:"4",y1:"4",x2:"10",y2:"10"})]})}const N=f((function(e){let{isConnectable:t,handleDelete:n,handleChange:a,handleDrop:o,inputValue:s,dataone:d}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(b.KP,{style:{background:"transparent",border:"none"},minWidth:100,minHeight:50,children:(0,c.jsx)(j,{})}),(0,c.jsxs)("div",{className:"text-updater-node groupnode groupnodediv",style:{position:"relative"},id:d.groupId,children:[(0,c.jsx)(l.HH,{type:"source",className:"chathandle",position:l.Ly.Top,isConnectable:t}),(0,c.jsx)("div",{className:"textareadiv quickdiv",children:"Quick Reply"}),(0,c.jsx)("label",{className:"groupLabel",children:"Message:"}),(0,c.jsx)("br",{}),(0,c.jsx)("textarea",{className:"groupinput activeborder",rows:"5",cols:"20",value:s,onChange:e=>a(e),onDrop:e=>o(e)}),(0,c.jsx)(l.HH,{type:"target",className:"chathandle",position:l.Ly.Left,isConnectable:t}),(0,c.jsx)(g,{deleteId:d.nodeId})]})]})}));var y=n(4294),C=n(5289),w=n(7123),D=n(9157),I=n(1691),k=n(5661),S=n(3581);function _(e){let{open:t,setOpenModal:n}=e;const o=(0,h.I0)(),l=()=>{n(!1)};return(0,c.jsx)(a.Fragment,{children:(0,c.jsxs)(C.Z,{open:t,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,c.jsx)(k.Z,{id:"alert-dialog-title",children:"Use Google's location service?"}),(0,c.jsx)(D.Z,{children:(0,c.jsx)(I.Z,{id:"alert-dialog-description",children:'Since You have choosen "Tier1", Adding card is restricted'})}),(0,c.jsxs)(w.Z,{children:[(0,c.jsx)(y.Z,{onClick:l,children:"Disagree"}),(0,c.jsx)(y.Z,{onClick:()=>{o((0,S._w)(5)),n(!1)},autoFocus:!0,children:"Agree"})]})]})})}var E=n(3330);const H=(0,a.forwardRef)(((e,t)=>{const{setNodes:n,nodes:o,reactFlowInstance:s,edges:d,onNodesChange:i,onEdgesChange:r,setReactFlowInstance:p,onDragOver:g,onStop:f,setEdges:b}=e,{getChatBotDataById:j}=(0,h.v9)(E.hQ),y=(0,a.useRef)(null);let C=(0,a.useContext)(x.s),{value:w,changeId:D,changeValue:I}=C;const[k,H]=(0,a.useState)(0),[L,T]=(0,a.useState)(!1),[Z,F]=(0,a.useState)({textupdater:N,buttonNode:v,textAreaUpdater:m});let R=(0,h.I0)();const B=(0,a.useRef)(o);(0,a.useEffect)((()=>{B.current=o}),[o,n]);const A=()=>{var e,t,n;let a=null===(e=B.current)||void 0===e?void 0:e.filter((e=>e.id.includes("dndnode"))),o=null===(t=a[a.length-1])||void 0===t||null===(n=t.id)||void 0===n?void 0:n.split("_")[1],l=o?parseInt(o)+1:0;return"dndnode_".concat(l++)},{payPrice:O}=(0,h.v9)((e=>e.flow));(0,a.useEffect)((()=>{V(D,w)}),[w,n]);const V=(e,t)=>{n((n=>n.map((n=>(n.id===e&&(n.data={...n.data,label:t}),n)))))},U=(0,a.useCallback)((e=>{var t;e.preventDefault();let a=e.target.id,o=e.target.classList[0];const l=y.current.getBoundingClientRect();let d=e.dataTransfer.getData("application/reactflow"),i=e.dataTransfer.getData("id");const r=null===(t=s.getNodes().find((e=>e.id===a)))||void 0===t?void 0:t.position;if("undefined"===typeof d||!d)return;if("headtext"===d)return;let c;const u=s.project({x:e.clientX-l.left,y:e.clientY-l.top});if(a.split("_").includes("groupnode")){const e={x:u.x-r.x-40,y:u.y-r.y-40};let t=A();c={id:t,type:d,position:e,parentNode:a,data:{nodeId:t}}}else if("react-flow__pane"===o&&i.split("_").includes("groupnode")){let e=(()=>{var e,t,n;let a=null===(e=B.current)||void 0===e?void 0:e.filter((e=>e.id.includes("groupnode"))),o=parseInt(null===(t=a[a.length-1])||void 0===t||null===(n=t.id)||void 0===n?void 0:n.split("_")[1])+1||0;return"groupnode_".concat(o++)})();c={id:e,type:d,position:u,data:{groupId:e,nodeId:e}}}else{let e=A();c={id:e,type:d,position:u,data:{nodeId:e}}}n((e=>e.concat(c)))}),[s]);(0,a.useEffect)((()=>{H(o.length),R((0,S.tL)({instance:s}))}),[o,R,n,j]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(l.tV,{children:[(0,c.jsxs)("div",{className:"reactflow-wrapper",id:"flowpaper",ref:y,children:[(0,c.jsx)(_,{open:L||"",setOpenModal:T}),(0,c.jsx)(l.x$,{nodes:o,edges:d,onNodesChange:i,onEdgesChange:r,onConnect:e=>b((t=>(e.markerEnd={type:l.QZ.ArrowClosed,width:20,height:20,color:"black"},e.className="customnode",(0,l.Z_)(e,t)))),onInit:p,className:"react-flow-subflows-example",onDrop:k<O?U:()=>{T(!0)},onDragOver:g,nodeTypes:Z,onNodeDragStop:f,fitView:!0})]}),(0,c.jsx)(u,{})]})})}));n(4645);var L=n(9955),T=n(2071);const Z=(e,t,n)=>{let o;const l=(0,a.useCallback)(((e,t,n)=>{const a=e.find((e=>e.id===n));if(!a)return null;const s={message:a.data.label||a.data.response};if("groupnode"==n.split("_")[0]){const a=e.filter((e=>e.parentNode===n)).map((e=>{let n=t.filter((t=>t.source===e.id))[0];return n||e}));a.length>0&&(s.options=a.map((n=>{if(null===n||void 0===n||!n.source)return{response:n.data.label};{const a=e.find((e=>e.id===(null===n||void 0===n?void 0:n.source))),s=e.find((e=>e.id===(null===n||void 0===n?void 0:n.target)));if(null===a||void 0===a||!a.parentNode)return o=null===s||void 0===s?void 0:s.id,{message:null===a||void 0===a?void 0:a.data.label,follow_up:l(e,t,null===s||void 0===s?void 0:s.id,null===a||void 0===a?void 0:a.id)};if(s)return o=s.id,{response:a.data.label,follow_up:l(e,t,s.id,a.id)}}})))}else{const a=t.filter((e=>e.source===n));a.length>0&&(s.options=a.map((n=>{const a=e.find((e=>e.id===n.source)),s=e.find((e=>e.id===n.target));if(o==a.id){o=s.id;let n=t.find((e=>e.source==a.id));e.find((e=>e.id==n.target));return{follow_up:l(e,t,s.id,a.id)}}return o!==a.id?(o=s.id,{message:a.data.label,follow_up:l(e,t,s.id,a.id)}):a.parentNode?(o=a.id,{response:a.data.label,follow_up:l(e,t,s.id,a.id)}):{follow_up:l(e,t,s.id,a.id)}})))}return s}),[e,t,n]);return{buildJSON:l}},F={inputProps:{"aria-label":"Switch demo"}},R=[{id:"1",type:"input",data:{label:"Start"},position:{x:250,y:5}}],B=()=>{const e=(0,a.useRef)(null),{buildJSON:t}=Z(),n=(0,o.TH)(),s=(0,o.s0)(),[d,i]=(0,a.useState)(null),[r,u,p]=(0,l.Rr)([]),[g,x,f]=(0,l.ll)([]);let{action:v="",arrayIndex:m=""}=(null===n||void 0===n?void 0:n.state)||{},b=(0,h.I0)();const{getChatBotDataByIdisLoading:j,getChatBotDataById:N}=(0,h.v9)(E.hQ),[y,C]=(0,a.useState)({clientName:"",chatbotName:""}),w=(0,a.useCallback)((e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),[]);(0,a.useEffect)((()=>{if(null!==N&&void 0!==N&&N.flow_data&&"Edit"==v){let e=null===N||void 0===N?void 0:N.flow_data;null===e||void 0===e||e.nodes;C({clientName:null===N||void 0===N?void 0:N.Chatbot_name,chatbotName:null===N||void 0===N?void 0:N.Chatbot_name}),u(null===e||void 0===e?void 0:e.nodes),x(null===e||void 0===e?void 0:e.edges)}else u(R)}),[N,v,u,x]),(0,a.useEffect)((()=>{m>0&&b((0,T.be)(m))}),[m,b,u,x]);const D=e=>{e.preventDefault();let{name:t,value:n}=null===e||void 0===e?void 0:e.target;C({...y,[t]:n})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"dndflowheader",children:[(0,c.jsx)("h2",{children:"Manage ChatBot"}),(0,c.jsxs)("div",{className:"dndflowfields",children:[(0,c.jsxs)("div",{className:"dndflowinput",children:[(0,c.jsx)("label",{children:"Client Name"}),(0,c.jsx)("input",{value:y.clientName,name:"clientName",onChange:e=>D(e)})]}),(0,c.jsxs)("div",{className:"dndflowinput",children:[(0,c.jsx)("label",{children:"Chatbot Name"}),(0,c.jsx)("input",{value:y.chatbotName,name:"chatbotName",onChange:e=>D(e)})]}),(0,c.jsxs)("div",{className:"dndactive",children:[(0,c.jsx)("label",{children:"Status:"}),(0,c.jsx)("span",{children:"Active"}),(0,c.jsx)(L.Z,{...F,defaultChecked:!0}),(0,c.jsx)("span",{children:"InActive"})]})]})]}),(0,c.jsxs)("div",{className:"dndflow",children:[(0,c.jsx)(H,{nodes:r,ref:e,edges:g,onNodesChange:p,onEdgesChange:f,setEdges:x,setReactFlowInstance:i,reactFlowInstance:d,onDragOver:w,setNodes:u,onStop:(e,t)=>{}}),(0,c.jsx)("button",{onClick:()=>(()=>{const e=t(d.toObject().nodes,d.toObject().edges,"1");let n={flow_data:d.toObject(),Chatbot_name:y.clientName,status:!0,json_content:e};b("Edit"==v?(0,T.Sk)(m,n):(0,T.oe)(n)),s("/dashboard/chatbot")})(),style:{backgroundColor:"#87cc87",margin:"10px",color:"white",fontWeight:"bolder",height:"30px",borderRadius:"5px",fontSize:"20px",position:"fixed",bottom:"0",right:"0",border:"none"},children:"Submit"})]})]})}},4645:()=>{}}]);
//# sourceMappingURL=231.8b04e0d6.chunk.js.map